config: '{{ rundir }}/experiment.yaml'
data:
  '{{ rundir }}/anl.grib2': https://nomads.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/gfs.{{ yyyymmdd }}/{{ hh }}/atmos/gfs.t{{ hh }}z.pgrb2.0p25.f000
hh: '{{ cycle.strftime("%H") }}'
rundir: '{{ runroot }}/05'
ungrib:
  execution:
    executable: ungrib
  gribfiles:
    - '{{ runroot }}/01/anl.grib2'
  rundir: '{{ rundir }}'
  start: '{{ cycle }}'
  step: 1
  stop: '{{ cycle }}'
  vtable: '{{ "WPSFILES" | env }}/Vtable.GFS'
workflow:
  attrs:
    realtime: false
    scheduler: slurm
  cycledef:
    - attrs:
        group: default
      spec: '{{ yyyymmddhhmm }} {{ yyyymmddhhmm }} 00:00:01'
  log:
    value: '{{ rundir }}/rocoto.log'
  tasks:
    task_ungrib:
      attrs:
        cycledefs: default
      account: '{{ account }}'
      command: '{{ activate }} && uw ungrib run -c {{ config }} --cycle {{ cycle.isoformat() }}'
      join: '{{ rundir }}/ungrib.log.slurm'
      native: -M c6
      nodes: 1:ppn=1
      partition: batch
      walltime: "00:01:00"
yyyymmdd: '{{ cycle.strftime("%Y%m%d") }}'
yyyymmddhhmm: '{{ cycle.strftime("%Y%m%d%H%M") }}'
